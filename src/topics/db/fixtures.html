
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fixtures &#8212; Django 5.0.7.dev20240507180756 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/default.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Examples of model relationship API usage" href="examples/index.html" />
    <link rel="prev" title="Database instrumentation" href="instrumentation.html" />



 
<script src="../../templatebuiltins.js"></script>
<script>
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../../ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);</script>

  </head><body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../../index.html">Django 5.0.7.dev20240507180756 documentation</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../../index.html">Home</a>  |
        <a title="Table of contents" href="../../contents.html">Table of contents</a>  |
        <a title="Global index" href="../../genindex.html">Index</a>  |
        <a title="Module index" href="../../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="instrumentation.html" title="Database instrumentation">previous</a>
     |
    <a href="../index.html" title="Using Django" accesskey="U">up</a>
   |
    <a href="examples/index.html" title="Examples of model relationship API usage">next</a> &raquo;</div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="topics-db-fixtures">
            
  <div class="section" id="s-fixtures">
<span id="s-fixtures-explanation"></span><span id="fixtures"></span><span id="fixtures-explanation"></span><h1>Fixtures<a class="headerlink" href="#fixtures" title="Permalink to this headline">¶</a></h1>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="last simple">
<li><a class="reference internal" href="../../howto/initial-data.html"><span class="doc">How to provide initial data for models</span></a></li>
</ul>
</div>
<div class="section" id="s-what-is-a-fixture">
<span id="what-is-a-fixture"></span><h2>What is a fixture?<a class="headerlink" href="#what-is-a-fixture" title="Permalink to this headline">¶</a></h2>
<p>A <em>fixture</em> is a collection of files that contain the serialized contents of
the database. Each fixture has a unique name, and the files that comprise the
fixture can be distributed over multiple directories, in multiple applications.</p>
</div>
<div class="section" id="s-how-to-produce-a-fixture">
<span id="how-to-produce-a-fixture"></span><h2>How to produce a fixture?<a class="headerlink" href="#how-to-produce-a-fixture" title="Permalink to this headline">¶</a></h2>
<p>Fixtures can be generated by <a class="reference internal" href="../../ref/django-admin.html#django-admin-dumpdata"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">manage.py</span> <span class="pre">dumpdata</span></code></a>. It’s
also possible to generate custom fixtures by directly using <a class="reference internal" href="../serialization.html"><span class="doc">serialization
tools</span></a> or even by handwriting them.</p>
</div>
<div class="section" id="s-how-to-use-a-fixture">
<span id="how-to-use-a-fixture"></span><h2>How to use a fixture?<a class="headerlink" href="#how-to-use-a-fixture" title="Permalink to this headline">¶</a></h2>
<p>Fixtures can be used to pre-populate database with data for
<a class="reference internal" href="../testing/tools.html#topics-testing-fixtures"><span class="std std-ref">tests</span></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">fixtures</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fixture-label&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>or to provide some <a class="reference internal" href="../../howto/initial-data.html#initial-data-via-fixtures"><span class="std std-ref">initial data</span></a> using the
<a class="reference internal" href="../../ref/django-admin.html#django-admin-loaddata"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">loaddata</span></code></a> command:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>django-admin<span class="w"> </span>loaddata<span class="w"> </span>&lt;fixture<span class="w"> </span>label&gt;
</pre></div>
</div>
</div>
<div class="section" id="s-where-django-looks-for-fixtures">
<span id="where-django-looks-for-fixtures"></span><h2>Where Django looks for fixtures?<a class="headerlink" href="#where-django-looks-for-fixtures" title="Permalink to this headline">¶</a></h2>
<p>Django will search in these locations for fixtures:</p>
<ol class="arabic simple">
<li>In the <code class="docutils literal notranslate"><span class="pre">fixtures</span></code> directory of every installed application</li>
<li>In any directory listed in the <a class="reference internal" href="../../ref/settings.html#std-setting-FIXTURE_DIRS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">FIXTURE_DIRS</span></code></a> setting</li>
<li>In the literal path named by the fixture</li>
</ol>
<p>Django will load any and all fixtures it finds in these locations that match
the provided fixture names. If the named fixture has a file extension, only
fixtures of that type will be loaded. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>django-admin<span class="w"> </span>loaddata<span class="w"> </span>mydata.json
</pre></div>
</div>
<p>would only load JSON fixtures called <code class="docutils literal notranslate"><span class="pre">mydata</span></code>. The fixture extension must
correspond to the registered name of a
<a class="reference internal" href="../serialization.html#serialization-formats"><span class="std std-ref">serializer</span></a> (e.g., <code class="docutils literal notranslate"><span class="pre">json</span></code> or <code class="docutils literal notranslate"><span class="pre">xml</span></code>).</p>
<p>If you omit the extensions, Django will search all available fixture types for
a matching fixture. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>django-admin<span class="w"> </span>loaddata<span class="w"> </span>mydata
</pre></div>
</div>
<p>would look for any fixture of any fixture type called <code class="docutils literal notranslate"><span class="pre">mydata</span></code>. If a fixture
directory contained <code class="docutils literal notranslate"><span class="pre">mydata.json</span></code>, that fixture would be loaded as a JSON
fixture.</p>
<p>The fixtures that are named can include directory components. These directories
will be included in the search path. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>django-admin<span class="w"> </span>loaddata<span class="w"> </span>foo/bar/mydata.json
</pre></div>
</div>
<p>would search <code class="docutils literal notranslate"><span class="pre">&lt;app_label&gt;/fixtures/foo/bar/mydata.json</span></code> for each installed
application, <code class="docutils literal notranslate"><span class="pre">&lt;dirname&gt;/foo/bar/mydata.json</span></code> for each directory in
<a class="reference internal" href="../../ref/settings.html#std-setting-FIXTURE_DIRS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">FIXTURE_DIRS</span></code></a>, and the literal path <code class="docutils literal notranslate"><span class="pre">foo/bar/mydata.json</span></code>.</p>
<div class="section" id="s-fixtures-loading-order">
<span id="fixtures-loading-order"></span><h3>Fixtures loading order<a class="headerlink" href="#fixtures-loading-order" title="Permalink to this headline">¶</a></h3>
<p>Multiple fixtures can be specified in the same invocation. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>django-admin<span class="w"> </span>loaddata<span class="w"> </span>mammals<span class="w"> </span>birds<span class="w"> </span>insects
</pre></div>
</div>
<p>or in a test case class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">AnimalTestCase</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>
    <span class="n">fixtures</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;mammals&quot;</span><span class="p">,</span> <span class="s2">&quot;birds&quot;</span><span class="p">,</span> <span class="s2">&quot;insects&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>The order in which fixtures are loaded follows the order in which they are
listed, whether it’s when using the management command or when listing them in
the test case class as shown above.</p>
<p>In these examples, all the fixtures named <code class="docutils literal notranslate"><span class="pre">mammals</span></code> from all applications (in
the order in which applications are defined in <a class="reference internal" href="../../ref/settings.html#std-setting-INSTALLED_APPS"><code class="xref std std-setting docutils literal notranslate"><span class="pre">INSTALLED_APPS</span></code></a>) will
be loaded first. Subsequently, all the <code class="docutils literal notranslate"><span class="pre">birds</span></code> fixtures will be loaded,
followed by all the <code class="docutils literal notranslate"><span class="pre">insects</span></code> fixtures.</p>
<p>Be aware that if the database backend supports row-level constraints, these
constraints will be checked at the end of the transaction. Any relationships
across fixtures may result in a load error if the database configuration does
not support deferred constraint checking (refer to the <a class="reference external" href="https://dev.mysql.com/doc/refman/en/constraint-foreign-key.html">MySQL</a> docs for an
example).</p>
</div>
</div>
<div class="section" id="s-how-fixtures-are-saved-to-the-database">
<span id="how-fixtures-are-saved-to-the-database"></span><h2>How fixtures are saved to the database?<a class="headerlink" href="#how-fixtures-are-saved-to-the-database" title="Permalink to this headline">¶</a></h2>
<p>When fixture files are processed, the data is saved to the database as is.
Model defined <a class="reference internal" href="../../ref/models/instances.html#django.db.models.Model.save" title="django.db.models.Model.save"><code class="xref py py-meth docutils literal notranslate"><span class="pre">save()</span></code></a> methods are not called, and
any <a class="reference internal" href="../../ref/signals.html#django.db.models.signals.pre_save" title="django.db.models.signals.pre_save"><code class="xref py py-data docutils literal notranslate"><span class="pre">pre_save</span></code></a> or
<a class="reference internal" href="../../ref/signals.html#django.db.models.signals.post_save" title="django.db.models.signals.post_save"><code class="xref py py-data docutils literal notranslate"><span class="pre">post_save</span></code></a> signals will be called with
<code class="docutils literal notranslate"><span class="pre">raw=True</span></code> since the instance only contains attributes that are local to the
model. You may, for example, want to disable handlers that access
related fields that aren’t present during fixture loading and would otherwise
raise an exception:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.db.models.signals</span> <span class="kn">import</span> <span class="n">post_save</span>
<span class="kn">from</span> <span class="nn">.models</span> <span class="kn">import</span> <span class="n">MyModel</span>


<span class="k">def</span> <span class="nf">my_handler</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># disable the handler during fixture loading</span>
    <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">]:</span>
        <span class="k">return</span>
    <span class="o">...</span>


<span class="n">post_save</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">my_handler</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="n">MyModel</span><span class="p">)</span>
</pre></div>
</div>
<p>You could also write a decorator to encapsulate this logic:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">wraps</span>


<span class="k">def</span> <span class="nf">disable_for_loaddata</span><span class="p">(</span><span class="n">signal_handler</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decorator that turns off signal handlers when loading fixture data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@wraps</span><span class="p">(</span><span class="n">signal_handler</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;raw&quot;</span><span class="p">]:</span>
            <span class="k">return</span>
        <span class="n">signal_handler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wrapper</span>


<span class="nd">@disable_for_loaddata</span>
<span class="k">def</span> <span class="nf">my_handler</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>Just be aware that this logic will disable the signals whenever fixtures are
deserialized, not just during <a class="reference internal" href="../../ref/django-admin.html#django-admin-loaddata"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">loaddata</span></code></a>.</p>
</div>
<div class="section" id="s-compressed-fixtures">
<span id="compressed-fixtures"></span><h2>Compressed fixtures<a class="headerlink" href="#compressed-fixtures" title="Permalink to this headline">¶</a></h2>
<p>Fixtures may be compressed in <code class="docutils literal notranslate"><span class="pre">zip</span></code>, <code class="docutils literal notranslate"><span class="pre">gz</span></code>, <code class="docutils literal notranslate"><span class="pre">bz2</span></code>, <code class="docutils literal notranslate"><span class="pre">lzma</span></code>, or <code class="docutils literal notranslate"><span class="pre">xz</span></code>
format. For example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>django-admin<span class="w"> </span>loaddata<span class="w"> </span>mydata.json
</pre></div>
</div>
<p>would look for any of <code class="docutils literal notranslate"><span class="pre">mydata.json</span></code>, <code class="docutils literal notranslate"><span class="pre">mydata.json.zip</span></code>, <code class="docutils literal notranslate"><span class="pre">mydata.json.gz</span></code>,
<code class="docutils literal notranslate"><span class="pre">mydata.json.bz2</span></code>, <code class="docutils literal notranslate"><span class="pre">mydata.json.lzma</span></code>, or <code class="docutils literal notranslate"><span class="pre">mydata.json.xz</span></code>. The first
file contained within a compressed archive is used.</p>
<p>Note that if two fixtures with the same name but different fixture type are
discovered (for example, if <code class="docutils literal notranslate"><span class="pre">mydata.json</span></code> and <code class="docutils literal notranslate"><span class="pre">mydata.xml.gz</span></code> were found in
the same fixture directory), fixture installation will be aborted, and any data
installed in the call to <a class="reference internal" href="../../ref/django-admin.html#django-admin-loaddata"><code class="xref std std-djadmin docutils literal notranslate"><span class="pre">loaddata</span></code></a> will be removed from the database.</p>
<div class="admonition-mysql-with-myisam-and-fixtures admonition">
<p class="first admonition-title">MySQL with MyISAM and fixtures</p>
<p class="last">The MyISAM storage engine of MySQL doesn’t support transactions or
constraints, so if you use MyISAM, you won’t get validation of fixture
data, or a rollback if multiple transaction files are found.</p>
</div>
</div>
<div class="section" id="s-database-specific-fixtures">
<span id="database-specific-fixtures"></span><h2>Database-specific fixtures<a class="headerlink" href="#database-specific-fixtures" title="Permalink to this headline">¶</a></h2>
<p>If you’re in a multi-database setup, you might have fixture data that
you want to load onto one database, but not onto another. In this
situation, you can add a database identifier into the names of your fixtures.</p>
<p>For example, if your <a class="reference internal" href="../../ref/settings.html#std-setting-DATABASES"><code class="xref std std-setting docutils literal notranslate"><span class="pre">DATABASES</span></code></a> setting has a <code class="docutils literal notranslate"><span class="pre">users</span></code> database
defined, name the fixture <code class="docutils literal notranslate"><span class="pre">mydata.users.json</span></code> or
<code class="docutils literal notranslate"><span class="pre">mydata.users.json.gz</span></code> and the fixture will only be loaded when you
specify you want to load data into the <code class="docutils literal notranslate"><span class="pre">users</span></code> database.</p>
</div>
</div>


          </div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../contents.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Fixtures</a><ul>
<li><a class="reference internal" href="#what-is-a-fixture">What is a fixture?</a></li>
<li><a class="reference internal" href="#how-to-produce-a-fixture">How to produce a fixture?</a></li>
<li><a class="reference internal" href="#how-to-use-a-fixture">How to use a fixture?</a></li>
<li><a class="reference internal" href="#where-django-looks-for-fixtures">Where Django looks for fixtures?</a><ul>
<li><a class="reference internal" href="#fixtures-loading-order">Fixtures loading order</a></li>
</ul>
</li>
<li><a class="reference internal" href="#how-fixtures-are-saved-to-the-database">How fixtures are saved to the database?</a></li>
<li><a class="reference internal" href="#compressed-fixtures">Compressed fixtures</a></li>
<li><a class="reference internal" href="#database-specific-fixtures">Database-specific fixtures</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="instrumentation.html"
                          title="previous chapter">Database instrumentation</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="examples/index.html"
                          title="next chapter">Examples of model relationship API usage</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/topics/db/fixtures.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
              <h3>Last update:</h3>
              <p class="topless">May 07, 2024</p>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="instrumentation.html" title="Database instrumentation">previous</a>
     |
    <a href="../index.html" title="Using Django" accesskey="U">up</a>
   |
    <a href="examples/index.html" title="Examples of model relationship API usage">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>